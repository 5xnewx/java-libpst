<!DOCTYPE html>
<html>

  <head>
    <meta charset='utf-8' />
    <meta http-equiv="X-UA-Compatible" content="chrome=1" />
    <meta name="description" content="Java-libpst : A library to read PST files with java, without need for external libraries." />

    <link rel="stylesheet" type="text/css" media="screen" href="stylesheets/stylesheet.css">

    <title>Java-libpst</title>
  </head>

  <body>

    <!-- HEADER -->
    <div id="header_wrap" class="outer">
        <header class="inner">
          <a id="forkme_banner" href="https://github.com/rjohnsondev/java-libpst">View on GitHub</a>

          <h1 id="project_title">Java-libpst</h1>
          <h2 id="project_tagline">A library to read PST files with java, without need for external libraries.</h2>

            <section id="downloads">
              <a class="zip_download_link" href="https://github.com/rjohnsondev/java-libpst/zipball/master">Download this project as a .zip file</a>
              <a class="tar_download_link" href="https://github.com/rjohnsondev/java-libpst/tarball/master">Download this project as a tar.gz file</a>
            </section>
        </header>
    </div>

    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">
      <section id="main_content" class="inner">
        <p>The PST File format is used by Outlook for the storage of emails.  Over the years many people have accumulated a large amount of important email and other information into these files, this project aims to allow people to access and extract this information so that it may be migrated to other messaging systems.</p>

<p>This project was originally based off the documentation created through the fantastic reverse engineering effort made by the <a href="https://sourceforge.net/projects/libpff">libpff</a> project.  The library has been improved with information provided by the release of the official PST specs by Microsoft.</p>

<p>The functional goals are:</p>

<ul>
<li>Efficiency; should be able to work with very large PST files with reasonable speed</li>
<li>Support for compressible encryption (on by default with newer versions of Outlook)</li>
<li>Intuitive API</li>
<li>Support for ANSI (32bit), Unicode (64bit) Outlook PST and Exchange OST Files.</li>
</ul><p>Things that the library will most likely not do:</p>

<ul>
<li>Fix or work with broken PST files</li>
<li>Provide write access to PST files</li>
<li>Recover deleted email items</li>
</ul><p>For example usage of the library please see the TestGui application stored in the examples folder.</p>

<p>Accessing the contents of a PSTFile is a matter of following the folder structure down to the desired email.  This example reads a PST and prints the tree structure to the console:</p>

<pre><code>package example;
import com.pff.*;
import java.util.*;

public class Test {
    public static void main(String[] args)
    {
        new Test(args[0]);
    }

    public Test(String filename) {
        try {
            PSTFile pstFile = new PSTFile(filename);
            System.out.println(pstFile.getMessageStore().getDisplayName());
            processFolder(pstFile.getRootFolder());
        } catch (Exception err) {
            err.printStackTrace();
        }
    }

    int depth = -1;
    public void processFolder(PSTFolder folder)
            throws PSTException, java.io.IOException
    {
        depth++;
        // the root folder doesn't have a display name
        if (depth &gt; 0) {
            printDepth();
            System.out.println(folder.getDisplayName());
        }

        // go through the folders...
        if (folder.hasSubfolders()) {
            Vector&lt;PSTFolder&gt; childFolders = folder.getSubFolders();
            for (PSTFolder childFolder : childFolders) {
                processFolder(childFolder);
            }
        }

        // and now the emails for this folder
        if (folder.getContentCount() &gt; 0) {
            depth++;
            PSTMessage email = (PSTMessage)folder.getNextChild();
            while (email != null) {
                printDepth();
                System.out.println("Email: "+email.getSubject());
                email = (PSTMessage)folder.getNextChild();
            }
            depth--;
        }
        depth--;
    }

    public void printDepth() {
        for (int x = 0; x &lt; depth-1; x++) {
            System.out.print(" | ");
        }
        System.out.print(" |- ");
    }
}
</code></pre>

<p>Attachments can be read through PSTAttachment.getFileInputStream like so:</p>

<pre><code>int numberOfAttachments = email.getNumberOfAttachments();
for (int x = 0; x &lt; numberOfAttachments; x++) {
    PSTAttachment attach = email.getAttachment(x);
    InputStream attachmentStream = attach.getFileInputStream();
    // both long and short filenames can be used for attachments
    String filename = attach.getLongFilename();
    if (filename.isEmpty()) {
        filename = attach.getFilename();
    }
    FileOutputStream out = new FileOutputStream(filename);
    // 8176 is the block size used internally and should give the best performance
    int bufferSize = 8176;
    byte[] buffer = new byte[bufferSize];
    int count = attachmentStream.read(buffer);
    while (count == bufferSize) {
        out.write(buffer);
        count = attachmentStream.read(buffer);
    }
    byte[] endBuffer = new byte[count];
    System.arraycopy(buffer, 0, endBuffer, 0, count);
    out.write(endBuffer);
    out.close();
    attachmentStream.close();
}
</code></pre>

<p>Each object in the PST has a unique identifier called a descriptor node id.  This can be useful for retrieving known objects quickly from the PST:</p>

<pre><code>long id = email.getDescriptorNodeId();
pstObject = PSTObject.detectAndLoadPSTObject(pstFile, id);
</code></pre>
      </section>
    </div>

    <!-- FOOTER  -->
    <div id="footer_wrap" class="outer">
      <footer class="inner">
        <p class="copyright">Java-libpst maintained by <a href="https://github.com/rjohnsondev">rjohnsondev</a></p>
        <p>Published with <a href="http://pages.github.com">GitHub Pages</a></p>
      </footer>
    </div>

    

  </body>
</html>
