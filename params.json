{"name":"Java-libpst","tagline":"A library to read PST files with java, without need for external libraries.","body":"The PST File format is used by Outlook for the storage of emails.  Over the years many people have accumulated a large amount of important email and other information into these files, this project aims to allow people to access and extract this information so that it may be migrated to other messaging systems.\r\n\r\nThis project was originally based off the documentation created through the fantastic reverse engineering effort made by the [libpff](https://sourceforge.net/projects/libpff) project.  The library has been improved with information provided by the release of the official PST specs by Microsoft.\r\n\r\nThe functional goals are:\r\n\r\n  * Efficiency; should be able to work with very large PST files with reasonable speed\r\n  * Support for compressible encryption (on by default with newer versions of Outlook)\r\n  * Intuitive API\r\n  * Support for ANSI (32bit), Unicode (64bit) Outlook PST and Exchange OST Files.\r\n\r\nThings that the library will most likely not do:\r\n\r\n  * Fix or work with broken PST files\r\n  * Provide write access to PST files\r\n  * Recover deleted email items\r\n\r\nFor example usage of the library please see the TestGui application stored in the examples folder.\r\n\r\nAccessing the contents of a PSTFile is a matter of following the folder structure down to the desired email.  This example reads a PST and prints the tree structure to the console:\r\n\r\n    package example;\r\n    import com.pff.*;\r\n    import java.util.*;\r\n\r\n    public class Test {\r\n        public static void main(String[] args)\r\n        {\r\n            new Test(args[0]);\r\n        }\r\n\r\n        public Test(String filename) {\r\n            try {\r\n                PSTFile pstFile = new PSTFile(filename);\r\n                System.out.println(pstFile.getMessageStore().getDisplayName());\r\n                processFolder(pstFile.getRootFolder());\r\n            } catch (Exception err) {\r\n                err.printStackTrace();\r\n            }\r\n        }\r\n\r\n        int depth = -1;\r\n        public void processFolder(PSTFolder folder)\r\n                throws PSTException, java.io.IOException\r\n        {\r\n            depth++;\r\n            // the root folder doesn't have a display name\r\n            if (depth > 0) {\r\n                printDepth();\r\n                System.out.println(folder.getDisplayName());\r\n            }\r\n\r\n            // go through the folders...\r\n            if (folder.hasSubfolders()) {\r\n                Vector<PSTFolder> childFolders = folder.getSubFolders();\r\n                for (PSTFolder childFolder : childFolders) {\r\n                    processFolder(childFolder);\r\n                }\r\n            }\r\n\r\n            // and now the emails for this folder\r\n            if (folder.getContentCount() > 0) {\r\n                depth++;\r\n                PSTMessage email = (PSTMessage)folder.getNextChild();\r\n                while (email != null) {\r\n                    printDepth();\r\n                    System.out.println(\"Email: \"+email.getSubject());\r\n                    email = (PSTMessage)folder.getNextChild();\r\n                }\r\n                depth--;\r\n            }\r\n            depth--;\r\n        }\r\n\r\n        public void printDepth() {\r\n            for (int x = 0; x < depth-1; x++) {\r\n                System.out.print(\" | \");\r\n            }\r\n            System.out.print(\" |- \");\r\n        }\r\n    }\r\n\r\nAttachments can be read through PSTAttachment.getFileInputStream like so:\r\n\r\n    int numberOfAttachments = email.getNumberOfAttachments();\r\n    for (int x = 0; x < numberOfAttachments; x++) {\r\n        PSTAttachment attach = email.getAttachment(x);\r\n        InputStream attachmentStream = attach.getFileInputStream();\r\n        // both long and short filenames can be used for attachments\r\n        String filename = attach.getLongFilename();\r\n        if (filename.isEmpty()) {\r\n            filename = attach.getFilename();\r\n        }\r\n        FileOutputStream out = new FileOutputStream(filename);\r\n        // 8176 is the block size used internally and should give the best performance\r\n        int bufferSize = 8176;\r\n        byte[] buffer = new byte[bufferSize];\r\n        int count = attachmentStream.read(buffer);\r\n        while (count == bufferSize) {\r\n            out.write(buffer);\r\n            count = attachmentStream.read(buffer);\r\n        }\r\n        byte[] endBuffer = new byte[count];\r\n        System.arraycopy(buffer, 0, endBuffer, 0, count);\r\n        out.write(endBuffer);\r\n        out.close();\r\n        attachmentStream.close();\r\n    }\r\n\r\nEach object in the PST has a unique identifier called a descriptor node id.  This can be useful for retrieving known objects quickly from the PST:\r\n\r\n    long id = email.getDescriptorNodeId();\r\n    pstObject = PSTObject.detectAndLoadPSTObject(pstFile, id);\r\n\r\n","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}